<div class="home-container">

  <div *ngIf="!loading && estadisticas" class="dashboard-content">
    <!-- KPIs Principales -->
    <div class="kpi-grid">
      <p-card class="kpi-card">
        <div class="kpi-content">
          <div class="kpi-icon">
            <i class="pi pi-users" style="font-size: 2.5rem; color: #3B82F6;"></i>
          </div>
          <div class="kpi-info">
            <h3>Total Personas Registradas</h3>
            <p class="kpi-value">{{ estadisticas.totalPersonasRegistradas | number }}</p>
          </div>
        </div>
      </p-card>

      <p-card class="kpi-card">
        <div class="kpi-content">
          <div class="kpi-icon">
            <i class="pi pi-calendar" style="font-size: 2.5rem; color: #10B981;"></i>
          </div>
          <div class="kpi-info">
            <h3>Personas Registradas Hoy</h3>
            <p class="kpi-value">{{ estadisticas.personasRegistradasHoy | number }}</p>
          </div>
        </div>
      </p-card>
    </div>

    <!-- Mapa de Calor con Google Maps -->
    <app-heatmap-map
      [datosHeatmap]="estadisticas.datosHeatmap"
      [datosStackedBar]="estadisticas.datosStackedBar"
      [paraderos]="paraderos">
    </app-heatmap-map>

    <!-- Gráfico: BARRAS APILADAS (Stacked Bar) -->
    <p-card class="chart-card-full">
      <ng-template pTemplate="header">
        <h3>Volumen por Ruta Desglosado por Paradero</h3>
        <p class="chart-description">Muestra la distribución de usuarios por ruta, segmentada por paradero</p>
      </ng-template>
      <p-chart
        type="bar"
        [data]="chartDataStackedBar"
        [options]="chartOptionsStackedBar"
        [style]="{'height': '500px'}">
      </p-chart>
    </p-card>
  </div>

  <div *ngIf="!loading && !estadisticas" class="empty-state">
    <i class="pi pi-inbox" style="font-size: 4rem; color: #ccc;"></i>
    <p>No hay datos disponibles</p>
  </div>
</div>

<p-toast></p-toast>
